<!-- These XML tags are added to Excel sheet at run-time by UDIMAGIC  -->
<XMLTAGS CELLREFERENCE="A1" FROMROW="5" xmlns:UDF="TallyUDF">
  <!-- Specifies that this (i.e Column as mentioned above) is the key field -->
  <COLUMNNAME.LIST>
    <COLUMNNAME>ID</COLUMNNAME>
    <COLUMNNAME>NAME</COLUMNNAME>
  </COLUMNNAME.LIST>
  <!-- Create VOUCHERTYPE Master -->
  <MASTER TYPE="VOUCHERTYPE">
    <NAME.LIST TYPE="String">
      <NAME COLUMNREFERENCE="C"/>
    </NAME.LIST>
    <PARENT COLUMNREFERENCE="B"/>
    <MAILINGNAME FORMULA="=if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;debit note&quot;),&quot;Purc&quot;,&quot;Sale&quot;)"/>
    <NUMBERINGMETHOD>Manual</NUMBERINGMETHOD>
    <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
  </MASTER>
  <!-- Create a GROUP Master -->
  <MASTER TYPE="GROUP" SINGLERECORD="YES">
    <NAME.LIST TYPE="String">
      <NAME>New Ledgers</NAME>
    </NAME.LIST>
  </MASTER>
  <!-- Create COSTCENTRE Masters -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AB"/>
    </NAME.LIST>
  </MASTER>
  <!-- Create Party Ledger Master-->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="H"/>
      <NAME COLUMNREFERENCE="I"/>
      <OLDNAME FORMULA="=IF(len(trim(I#))=0,H#,I#)"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(J#))=0,if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),&quot;Sundry Creditors&quot;,&quot;Sundry Debtors&quot;),J#)"/>
    <ISBILLWISEON>Yes</ISBILLWISEON>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <!-- Required for Tally ERP 9 Release 5.1 and higher -->
    <!-- 2017-09-14: STATENAME is converted to proper-case  -->
    <STATENAME FORMULA="=proper(trim(K#))"/>
    <LEDSTATENAME FORMULA="=proper(trim(K#))"/>
    <COUNTRYNAME FORMULA="=if(len(trim(L#))=0,&quot;India&quot;,L#)"/>
    <!-- GST fields for PARTY LEDGER -->
    <GSTREGISTRATIONTYPE FORMULA="=if(len(trim(M#))&gt;0,M#,if(len(trim(N#))&gt;0,&quot;Regular&quot;,&quot;Unregistered&quot;))"/>
    <!-- GSTIN / UIN -->
    <PARTYGSTIN FORMULA="=trim(N#)"/>
    <!-- Tally Prime 3.0 -->
    <LEDGSTREGDETAILS.LIST>
      <APPLICABLEFROM>20230401</APPLICABLEFROM>
      <GSTREGISTRATIONTYPE FORMULA="=if(len(trim(M#))&gt;0,M#,if(len(trim(N#))&gt;0,&quot;Regular&quot;,&quot;Unregistered/Consumer&quot;))"/>
      <STATE FORMULA="=proper(trim(K#))"/>
      <GSTIN FORMULA="=trim(N#)"/>
    </LEDGSTREGDETAILS.LIST>
    <!-- Tally Prime 3.0 -->
    <LEDMAILINGDETAILS.LIST>
      <APPLICABLEFROM>20230401</APPLICABLEFROM>
      <MAILINGNAME COLUMNREFERENCE="H"/>
      <STATE FORMULA="=proper(trim(K#))"/>
      <COUNTRY FORMULA="=if(len(trim(L#))=0,&quot;India&quot;,L#)"/>
    </LEDMAILINGDETAILS.LIST>
  </MASTER>
  <!-- Create Ledger 1 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AK"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(AM#))=0,&quot;New Ledgers&quot;,AM#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(AO#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 2 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AP"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(AR#))=0,&quot;New Ledgers&quot;,AR#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(AT#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 3 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AU"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(AW#))=0,&quot;New Ledgers&quot;,AW#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(AY#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 4 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AZ"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(BB#))=0,&quot;New Ledgers&quot;,BB#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(BD#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 5 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BE"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(BG#))=0,&quot;New Ledgers&quot;,BG#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(BI#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 6 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BJ"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(BL#))=0,&quot;New Ledgers&quot;,BL#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(BN#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 7 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BO"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(BQ#))=0,&quot;New Ledgers&quot;,BQ#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(BS#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 8 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BT"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(BV#))=0,&quot;New Ledgers&quot;,BV#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(BX#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 9 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BY"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CA#))=0,&quot;New Ledgers&quot;,CA#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(CC#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 10 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CD"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CF#))=0,&quot;New Ledgers&quot;,CF#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(CH#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 11 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CI"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CK#))=0,&quot;New Ledgers&quot;,CK#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(CM#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 12 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CN"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CP#))=0,&quot;New Ledgers&quot;,CP#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(CR#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 13 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CS"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CU#))=0,&quot;New Ledgers&quot;,CU#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(CW#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 14 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CX"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(CZ#))=0,&quot;New Ledgers&quot;,CZ#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(DB#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 15 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DC"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(DE#))=0,&quot;New Ledgers&quot;,DE#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(DG#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 16 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DH"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(DJ#))=0,&quot;New Ledgers&quot;,DJ#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(DL#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 17 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DM"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(DO#))=0,&quot;New Ledgers&quot;,DO#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(DQ#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 18 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DR"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(DT#))=0,&quot;New Ledgers&quot;,DT#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(DV#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 19 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DW"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(DY#))=0,&quot;New Ledgers&quot;,DY#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EA#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 20 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EB"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(ED#))=0,&quot;New Ledgers&quot;,ED#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EF#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 21 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EG"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(EI#))=0,&quot;New Ledgers&quot;,EI#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EK#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 22 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EL"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(EN#))=0,&quot;New Ledgers&quot;,EN#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EP#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 23 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EQ"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(ES#))=0,&quot;New Ledgers&quot;,ES#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EU#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 24 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EV"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(EX#))=0,&quot;New Ledgers&quot;,EX#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(EZ#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 25 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FA"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(FC#))=0,&quot;New Ledgers&quot;,FC#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(FE#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 26 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FF"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(FH#))=0,&quot;New Ledgers&quot;,FH#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(FJ#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 27 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FK"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(FM#))=0,&quot;New Ledgers&quot;,FM#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(FO#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 28 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FP"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(FR#))=0,&quot;New Ledgers&quot;,FR#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(FT#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 29 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FU"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim(FW#))=0,&quot;New Ledgers&quot;,FW#)"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim(FY#))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Ledger 30 -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FZ"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(len(trim((null)))=0,&quot;New Ledgers&quot;,(null))"/>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <ISCOSTCENTRESON FORMULA="=If(Len(trim((null)))&gt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
  </MASTER>
  <!-- Create Round Off LEDGER Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(AE#))=0,&quot;Round Off&quot;,AE#)"/>
    </NAME.LIST>
    <PARENT>Indirect Expenses</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AN"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AS"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AX"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BC"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BH"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BM"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BR"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BW"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CB"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CG"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CL"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CQ"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CV"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DA"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DF"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DK"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DP"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DU"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DZ"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EE"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EJ"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EO"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="ET"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EY"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FD"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FI"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FN"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FS"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FX"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Category -->
  <MASTER TYPE="COSTCATEGORY">
    <NAME.LIST>
      <NAME FORMULA="=(null)"/>
    </NAME.LIST>
    <ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
    <ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AO"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="AN"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AT"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="AS"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="AY"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="AX"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BD"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="BC"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BI"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="BH"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BN"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="BM"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BS"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="BR"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="BX"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="BW"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CC"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="CB"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CH"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="CG"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CM"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="CL"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CR"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="CQ"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="CW"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="CV"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DB"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DA"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DG"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DF"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DL"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DK"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DQ"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DP"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="DV"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DU"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EA"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="DZ"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EF"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="EE"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EK"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="EJ"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EP"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="EO"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EU"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="ET"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="EZ"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="EY"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FE"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="FD"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FJ"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="FI"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FO"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="FN"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FT"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="FS"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="FY"/>
    </NAME.LIST>
    <CATEGORY COLUMNREFERENCE="FX"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- Cost Centre -->
  <MASTER TYPE="COSTCENTRE">
    <NAME.LIST>
      <NAME FORMULA="=(null)"/>
    </NAME.LIST>
    <CATEGORY FORMULA="=(null)"/>
    <REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
  </MASTER>
  <!-- VOUCHER-->
  <VOUCHER12>

    <!-- Tally Prime 3.0 -->
    <GSTREGISTRATION TAXTYPE="GST" COLUMNREFERENCE="AH"/>
    <CMPGSTSTATE COLUMNREFERENCE="AG"/>
    <CMPGSTIN COLUMNREFERENCE="AI"/>
    <CMPGSTREGISTRATIONTYPE COLUMNREFERENCE="AJ"/>

    <GUID FORMULA="=+&quot;udi-D5U9Q2-&quot; &amp; A# &amp; &quot;-&quot; &amp; C# &amp; &quot;-&quot; &amp; E#"/>
    <DATE COLUMNREFERENCE="E"/>
    <EFFECTIVEDATE COLUMNREFERENCE="E"/>
    <VOUCHERTYPENAME COLUMNREFERENCE="C"/>
    <ISINVOICE COLUMNREFERENCE="AF"/>
    <PERSISTEDVIEW FORMULA="=if(trim(AF#[1])=&quot;Yes&quot;,&quot;Invoice Voucher View&quot;,&quot;Accounting Voucher View&quot;)"/>
    <!-- GSTIN / UIN -->
    <PARTYGSTIN FORMULA="=if(len(trim(W#))&gt;0,W#,N#)"/>
    <!-- 2017-09-14: STATENAME is converted to proper-case  -->
    <STATENAME FORMULA="=proper(if(len(trim(P#))=0,trim(K#),&quot;&quot;))"/>
    <STATENAME FORMULA="=proper(trim(T#))"/>
    <COUNTRYNAME FORMULA="=if(len(trim(U#))&gt;0,U#,if(len(trim(L#))&gt;0,L#,&quot;India&quot;))"/>
    <COUNTRYOFRESIDENCE FORMULA="=if(len(trim(U#))&gt;0,U#,if(len(trim(L#))&gt;0,L#,&quot;India&quot;))"/>
    <PARTYLEDGERNAME COLUMNREFERENCE="H"/>
    <VOUCHERNUMBER COLUMNREFERENCE="D"/>
    <REFERENCE COLUMNREFERENCE="F"/>
    <UDF:REFERENCEDATE.LIST DESC="`ReferenceDate`" ISLIST="YES" TYPE="Date">
      <UDF:REFERENCEDATE DESC="`ReferenceDate`" COLUMNREFERENCE="G"/>
    </UDF:REFERENCEDATE.LIST>
    <REFERENCEDATE COLUMNREFERENCE="G"/>
    <NARRATION COLUMNREFERENCE="AC"/>
    <COSTCENTRENAME COLUMNREFERENCE="AB"/>
    <ISCOSTCENTRE FORMULA="=if(len(AB#)=0,&quot;No&quot;,&quot;Yes&quot;)"/>
    <!-- Supplier details for Purchase  -->
    <PARTYNAME FORMULA="=if(len(trim(P#))=0,H#,P#)"/>
    <ADDRESS.LIST SKIP="=And(len(trim(Q#))=0,len(trim(R#))=0,len(trim(S#))=0,len(trim(T#))=0)">
      <ADDRESS COLUMNREFERENCE="Q"/>
      <ADDRESS COLUMNREFERENCE="R"/>
      <ADDRESS COLUMNREFERENCE="S"/>
      <ADDRESS COLUMNREFERENCE="T"/>
    </ADDRESS.LIST>
    <!-- Buyer details for Sales -->
    <BASICBUYERNAME FORMULA="=if(len(trim(P#))=0,H#,P#)"/>
    <BASICBUYERADDRESS.LIST SKIP="=And(len(trim(Q#))=0,len(trim(R#))=0,len(trim(S#))=0,len(trim(T#))=0)">
      <BASICBUYERADDRESS COLUMNREFERENCE="Q"/>
      <BASICBUYERADDRESS COLUMNREFERENCE="R"/>
      <BASICBUYERADDRESS COLUMNREFERENCE="S"/>
    </BASICBUYERADDRESS.LIST>
    <PLACEOFSUPPLY FORMULA="=proper(trim(if(len(trim(O#))&gt;0,O#,if(len(trim(T#))&gt;0,T#,K#))))"/>
    <GSTREGISTRATIONTYPE FORMULA="=if(len(trim(V#))&gt;0,V#,if(len(trim(M#))&gt;0,M#,if(len(trim(N#))&gt;0,&quot;Regular&quot;,&quot;Unregistered&quot;)))"/>
    <!-- Other GST details -->
    <GSTNATUREOFRETURN SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))" FORMULA="=if(len(trim(X#))=0,&quot;01-Sales Return&quot;,X#)"/>
    <VATPARTYTRANSRETURNNUMBER SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))" FORMULA="=if(len(trim(Y#))=0,F#,Y#)"/>
    <VATPARTYTRANSRETURNDATE SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))" FORMULA="=if(len(trim(Z#))=0,G#,Z#)"/>
    <URDORIGINALSALEVALUE SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))" FORMULA="=if(len(trim(AA#))=0,&quot;Lesser than or equal to 2.5 lakhs&quot;,AA#)"/>
    <!-- Sales, Purchase Return   : Party Ledger to be Debited -->
    <!-- Purchase, Sales Return   : Party Ledger to be Credited -->
    <ALLLEDGERENTRIES.LIST ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=IF(len(trim(I#))=0,H#,I#)"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
      <AMOUNT FORMULA="=Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},if(trim(AD#)=&quot;yes&quot;,0,2))*if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),1,-1)"/>
      <BILLALLOCATIONS.LIST SKIP="=Len(Trim(F#))=0">
        <NAME COLUMNREFERENCE="F"/>
        <BILLTYPE>New Ref</BILLTYPE>
        <AMOUNT FORMULA="=Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},if(trim(AD#)=&quot;yes&quot;,0,2))*if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),1,-1)"/>
      </BILLALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- Sales/Purchase and Tax Ledgers  -->
    <!-- LEDGER 1 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(AK#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(AL#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="AK"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <!--                
        ISDEEMEDPOSITIVE
        purchase,credit note and AL# greater than 0   Yes
        sales,debit note and AL# less than 0          Yes
        Otherwise                     No
      -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AL#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AL#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(AL#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(AO#))=0">
        <CATEGORY FORMULA="=if(len(trim(AN#))=0,&quot;Primary Cost Category&quot;,AN#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AL#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AL#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="AO"/>
          <AMOUNT FORMULA="={Round(AL#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 2 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(AP#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(AQ#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="AP"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AQ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AQ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(AQ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(AT#))=0">
        <CATEGORY FORMULA="=if(len(trim(AS#))=0,&quot;Primary Cost Category&quot;,AS#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AQ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AQ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="AT"/>
          <AMOUNT FORMULA="={Round(AQ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 3 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(AU#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(AV#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="AU"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AV#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AV#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(AV#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(AY#))=0">
        <CATEGORY FORMULA="=if(len(trim(AX#))=0,&quot;Primary Cost Category&quot;,AX#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(AV#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(AV#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="AY"/>
          <AMOUNT FORMULA="={Round(AV#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 4 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(AZ#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BA#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="AZ"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BA#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BA#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BA#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(BD#))=0">
        <CATEGORY FORMULA="=if(len(trim(BC#))=0,&quot;Primary Cost Category&quot;,BC#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BA#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BA#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="BD"/>
          <AMOUNT FORMULA="={Round(BA#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 5 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(BE#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BF#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="BE"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BF#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BF#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BF#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(BI#))=0">
        <CATEGORY FORMULA="=if(len(trim(BH#))=0,&quot;Primary Cost Category&quot;,BH#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BF#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BF#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="BI"/>
          <AMOUNT FORMULA="={Round(BF#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 6 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(BJ#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BK#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="BJ"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BK#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BK#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BK#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(BN#))=0">
        <CATEGORY FORMULA="=if(len(trim(BM#))=0,&quot;Primary Cost Category&quot;,BM#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BK#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BK#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="BN"/>
          <AMOUNT FORMULA="={Round(BK#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 7 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(BO#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BP#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="BO"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BP#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BP#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BP#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(BS#))=0">
        <CATEGORY FORMULA="=if(len(trim(BR#))=0,&quot;Primary Cost Category&quot;,BR#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BP#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BP#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="BS"/>
          <AMOUNT FORMULA="={Round(BP#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 8 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(BT#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BU#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="BT"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BU#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BU#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BU#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(BX#))=0">
        <CATEGORY FORMULA="=if(len(trim(BW#))=0,&quot;Primary Cost Category&quot;,BW#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BU#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BU#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="BX"/>
          <AMOUNT FORMULA="={Round(BU#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 9 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(BY#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(BZ#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="BY"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BZ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BZ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(BZ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(CC#))=0">
        <CATEGORY FORMULA="=if(len(trim(CB#))=0,&quot;Primary Cost Category&quot;,CB#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(BZ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(BZ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="CC"/>
          <AMOUNT FORMULA="={Round(BZ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 10 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(CD#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(CE#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="CD"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CE#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CE#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(CE#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(CH#))=0">
        <CATEGORY FORMULA="=if(len(trim(CG#))=0,&quot;Primary Cost Category&quot;,CG#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CE#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CE#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="CH"/>
          <AMOUNT FORMULA="={Round(CE#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 11 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(CI#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(CJ#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="CI"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CJ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CJ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(CJ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(CM#))=0">
        <CATEGORY FORMULA="=if(len(trim(CL#))=0,&quot;Primary Cost Category&quot;,CL#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CJ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CJ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="CM"/>
          <AMOUNT FORMULA="={Round(CJ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 12 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(CN#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(CO#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="CN"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CO#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CO#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(CO#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(CR#))=0">
        <CATEGORY FORMULA="=if(len(trim(CQ#))=0,&quot;Primary Cost Category&quot;,CQ#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CO#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CO#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="CR"/>
          <AMOUNT FORMULA="={Round(CO#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 13 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(CS#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(CT#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="CS"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CT#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CT#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(CT#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(CW#))=0">
        <CATEGORY FORMULA="=if(len(trim(CV#))=0,&quot;Primary Cost Category&quot;,CV#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CT#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CT#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="CW"/>
          <AMOUNT FORMULA="={Round(CT#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 14 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(CX#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(CY#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="CX"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CY#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CY#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(CY#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(DB#))=0">
        <CATEGORY FORMULA="=if(len(trim(DA#))=0,&quot;Primary Cost Category&quot;,DA#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(CY#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(CY#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="DB"/>
          <AMOUNT FORMULA="={Round(CY#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 15 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(DC#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(DD#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="DC"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DD#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DD#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(DD#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(DG#))=0">
        <CATEGORY FORMULA="=if(len(trim(DF#))=0,&quot;Primary Cost Category&quot;,DF#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DD#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DD#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="DG"/>
          <AMOUNT FORMULA="={Round(DD#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 16 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(DH#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(DI#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="DH"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DI#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DI#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(DI#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(DL#))=0">
        <CATEGORY FORMULA="=if(len(trim(DK#))=0,&quot;Primary Cost Category&quot;,DK#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DI#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DI#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="DL"/>
          <AMOUNT FORMULA="={Round(DI#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 17 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(DM#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(DN#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="DM"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DN#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DN#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(DN#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(DQ#))=0">
        <CATEGORY FORMULA="=if(len(trim(DP#))=0,&quot;Primary Cost Category&quot;,DP#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DN#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DN#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="DQ"/>
          <AMOUNT FORMULA="={Round(DN#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 18 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(DR#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(DS#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="DR"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DS#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DS#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(DS#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(DV#))=0">
        <CATEGORY FORMULA="=if(len(trim(DU#))=0,&quot;Primary Cost Category&quot;,DU#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DS#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DS#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="DV"/>
          <AMOUNT FORMULA="={Round(DS#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 19 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(DW#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(DX#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="DW"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DX#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DX#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(DX#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EA#))=0">
        <CATEGORY FORMULA="=if(len(trim(DZ#))=0,&quot;Primary Cost Category&quot;,DZ#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(DX#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(DX#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EA"/>
          <AMOUNT FORMULA="={Round(DX#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 20 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(EB#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(EC#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="EB"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EC#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EC#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(EC#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EF#))=0">
        <CATEGORY FORMULA="=if(len(trim(EE#))=0,&quot;Primary Cost Category&quot;,EE#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EC#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EC#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EF"/>
          <AMOUNT FORMULA="={Round(EC#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 21 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(EG#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(EH#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="EG"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EH#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EH#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(EH#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EK#))=0">
        <CATEGORY FORMULA="=if(len(trim(EJ#))=0,&quot;Primary Cost Category&quot;,EJ#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EH#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EH#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EK"/>
          <AMOUNT FORMULA="={Round(EH#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 22 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(EL#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(EM#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="EL"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EM#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EM#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(EM#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EP#))=0">
        <CATEGORY FORMULA="=if(len(trim(EO#))=0,&quot;Primary Cost Category&quot;,EO#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EM#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EM#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EP"/>
          <AMOUNT FORMULA="={Round(EM#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 23 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(EQ#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(ER#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="EQ"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(ER#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(ER#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(ER#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EU#))=0">
        <CATEGORY FORMULA="=if(len(trim(ET#))=0,&quot;Primary Cost Category&quot;,ET#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(ER#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(ER#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EU"/>
          <AMOUNT FORMULA="={Round(ER#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 24 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(EV#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(EW#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="EV"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EW#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EW#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(EW#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(EZ#))=0">
        <CATEGORY FORMULA="=if(len(trim(EY#))=0,&quot;Primary Cost Category&quot;,EY#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(EW#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(EW#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="EZ"/>
          <AMOUNT FORMULA="={Round(EW#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 25 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FA#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(FB#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FA"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FB#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FB#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(FB#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(FE#))=0">
        <CATEGORY FORMULA="=if(len(trim(FD#))=0,&quot;Primary Cost Category&quot;,FD#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FB#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FB#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="FE"/>
          <AMOUNT FORMULA="={Round(FB#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 26 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FF#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(FG#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FF"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FG#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FG#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(FG#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(FJ#))=0">
        <CATEGORY FORMULA="=if(len(trim(FI#))=0,&quot;Primary Cost Category&quot;,FI#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FG#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FG#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="FJ"/>
          <AMOUNT FORMULA="={Round(FG#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 27 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FK#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(FL#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FK"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FL#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FL#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(FL#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(FO#))=0">
        <CATEGORY FORMULA="=if(len(trim(FN#))=0,&quot;Primary Cost Category&quot;,FN#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FL#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FL#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="FO"/>
          <AMOUNT FORMULA="={Round(FL#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 28 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FP#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(FQ#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FP"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FQ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FQ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(FQ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(FT#))=0">
        <CATEGORY FORMULA="=if(len(trim(FS#))=0,&quot;Primary Cost Category&quot;,FS#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FQ#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FQ#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="FT"/>
          <AMOUNT FORMULA="={Round(FQ#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 29 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FU#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round(FV#,2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FU"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FV#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FV#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(FV#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim(FY#))=0">
        <CATEGORY FORMULA="=if(len(trim(FX#))=0,&quot;Primary Cost Category&quot;,FX#)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round(FV#,2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round(FV#,2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME COLUMNREFERENCE="FY"/>
          <AMOUNT FORMULA="={Round(FV#,2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- LEDGER 30 -->
    <ALLLEDGERENTRIES.LIST GROUPBY="=trim(FZ#)" ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="={Round((null),2)}=0">
      <LEDGERNAME COLUMNREFERENCE="FZ"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round((null),2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round((null),2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round((null),2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
      <!-- Cost Centre details -->
      <CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
        <CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),{Round((null),2)}&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),{Round((null),2)}&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
        <COSTCENTREALLOCATIONS.LIST>
          <NAME FORMULA="=(null)"/>
          <AMOUNT FORMULA="={Round((null),2)}*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
        </COSTCENTREALLOCATIONS.LIST>
      </CATEGORYALLOCATIONS.LIST>
    </ALLLEDGERENTRIES.LIST>
    <!-- Round Off -->
    <ALLLEDGERENTRIES.LIST ALTERNATETAGNAME="=if(trim(AF#[1])=&quot;yes&quot;,&quot;LEDGERENTRIES.LIST&quot;,&quot;&quot;)" SKIP="=Not(trim(AD#)=&quot;yes&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(AE#))=0,&quot;Round Off&quot;,AE#)"/>
      <!-- For Invoice Mode -->
      <ISDEEMEDPOSITIVE SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))" FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Voucher Mode -->
      <ISDEEMEDPOSITIVE SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)" FORMULA="=if(Or(And(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),Round(Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},0)-Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},2),2)&gt;0),And(Or(trim($B#[1])=&quot;sales&quot;,trim($B#[1])=&quot;debit note&quot;),Round(Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},0)-Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},2),2)&lt;0)),&quot;Yes&quot;,&quot;No&quot;)"/>
      <!-- For Invoice Mode -->
      <TEST SKIP="=Not(And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;))">ISINVOICEMODE=YES</TEST>
      <!-- For Voucher Mode -->
      <TEST SKIP="=And(Len(trim(AF#[1]))&gt;0,trim(AF#[1])=&quot;Yes&quot;)">ISINVOICEMODE=NO</TEST>
      <AMOUNT FORMULA="=Round(Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},0)-Round({Round(AL#,2)+Round(AQ#,2)+Round(AV#,2)+Round(BA#,2)+Round(BF#,2)}+{Round(BK#,2)+Round(BP#,2)+Round(BU#,2)+Round(BZ#,2)+Round(CE#,2)}+{Round(CJ#,2)+Round(CO#,2)+Round(CT#,2)+Round(CY#,2)+Round(DD#,2)}+{Round(DI#,2)+Round(DN#,2)+Round(DS#,2)+Round(DX#,2)+Round(EC#,2)}+{Round(EH#,2)+Round(EM#,2)+Round(ER#,2)+Round(EW#,2)+Round(FB#,2)}+{Round(FG#,2)+Round(FL#,2)+Round(FQ#,2)+Round(FV#,2)+Round((null),2)},2),2)*if(Or(trim($B#[1])=&quot;purchase&quot;,trim($B#[1])=&quot;credit note&quot;),-1,1)"/>
    </ALLLEDGERENTRIES.LIST>
    <DUMMY SCROLL="YES"/>
  </VOUCHER12>
</XMLTAGS>